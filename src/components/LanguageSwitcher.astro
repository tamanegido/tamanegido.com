---
import { languages, type Language } from '../i18n';

interface Props {
	currentLang: Language;
	currentPath: string;
}

const { currentLang, currentPath } = Astro.props;

const getPathForLang = (lang: Language): string => {
	if (currentPath === '/') {
		return lang === 'ja' ? '/' : '/en';
	}
	if (currentPath === '/ja/') {
		return lang === 'ja' ? '/' : '/en';
	}
	const pathWithoutLang = currentPath.replace(/^\/(ja|en)/, '').replace(/^\//, '');
	return lang === 'ja' ? `/${pathWithoutLang}` : `/en/${pathWithoutLang}`;
};
---

<div class="language-switcher">
	{languages.map((lang) => (
		<a
			href={getPathForLang(lang)}
			class={currentLang === lang ? 'active' : ''}
			aria-label={`Switch to ${lang === 'ja' ? 'Japanese' : 'English'}`}
		>
			{lang === 'ja' ? '日本語' : 'English'}
		</a>
	))}
</div>

<style>
	.language-switcher {
		display: flex;
		gap: 0.5rem;
		justify-content: flex-end;
	}

	.language-switcher a {
		padding: 0.4rem 0.9rem;
		border-radius: 0.4rem;
		text-decoration: none;
		color: #333;
		border: 1px solid rgba(0, 0, 0, 0.15);
		background-color: white;
		transition: all 0.2s;
		font-family: system-ui, -apple-system, sans-serif;
		font-size: 0.875rem;
		font-weight: 500;
		line-height: 1.4;
		white-space: nowrap;
		display: inline-block;
	}

	.language-switcher a:hover {
		background-color: rgba(0, 0, 0, 0.05);
		border-color: rgba(0, 0, 0, 0.25);
		color: #111;
	}

	.language-switcher a.active {
		background-color: rgba(var(--accent), 0.15);
		color: rgb(var(--accent));
		border-color: rgba(var(--accent), 0.3);
		font-weight: 600;
	}

	.language-switcher a.active:hover {
		background-color: rgba(var(--accent), 0.2);
		border-color: rgba(var(--accent), 0.4);
	}
</style>

